Metadata-Version: 2.4
Name: multitabfm
Version: 0.1.0
Summary: Multi-table feature modeling framework with AutoGluon integration
Author: AWS Shanghai AI Lab
Maintainer: AWS Shanghai AI Lab
License: MIT
Project-URL: Homepage, https://github.com/your-username/multitabfm
Project-URL: Documentation, https://multitabfm.readthedocs.io/
Project-URL: Repository, https://github.com/your-username/multitabfm.git
Project-URL: Bug Tracker, https://github.com/your-username/multitabfm/issues
Keywords: machine learning,feature engineering,autogluon,multi-table,dfs,tabular data
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Scientific/Engineering
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: pandas
Requires-Dist: numpy
Requires-Dist: PyYAML
Requires-Dist: scikit-learn
Requires-Dist: autogluon.tabular>=1.0.0
Requires-Dist: tabpfn==2.1.3
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: black>=22.0.0; extra == "dev"
Requires-Dist: isort>=5.10.0; extra == "dev"
Requires-Dist: flake8>=5.0.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Provides-Extra: testing
Requires-Dist: pytest>=7.0.0; extra == "testing"
Requires-Dist: pytest-cov>=4.0.0; extra == "testing"

# MultiTabFM

MultiTabFM is a lightweight multi-table feature modeling framework that pairs Deep Feature Synthesis (DFS) with AutoGluon for end-to-end tabular modeling on relational data.

## Overview

What you get out of the box:
- DFS-based multi-table feature generation via the local fastdfs package
- Automated model training and prediction using AutoGluon Tabular
- A one-call training-and-prediction API and a step-by-step interface
- Simple evaluation utilities for common metrics (accuracy, roc_auc, logloss)

## Installation

Install in editable mode inside this repository folder:

```bash
git clone https://github.com/dglai/multitabfm.git
cd multitabfm
pip install -e .
```

## Quick Start

### One-call API

```python
from multitabfm import train_and_predict

proba, metrics = train_and_predict(
    rdb_data_path="data/rel-event",                 # path used by fastdfs.load_rdb
    task_data_path="data/rel-event/user-ignore",    # must contain train.pqt, test.pqt, metadata.yaml
    eval_metrics=["accuracy", "roc_auc"],
)

print(proba)
print(metrics)
```

### Step-by-step usage

```python
import pandas as pd
from multitabfm import (
    MultiTabFM,
    load_dataset,
    prepare_target_dataframes,
    generate_features,
)

# 1) Load raw task data, metadata, and RDB
train_data, test_data, metadata, rdb = load_dataset(
    rdb_data_path="data/rel-event",
    task_data_path="data/rel-event/user-ignore",
)

# 2) Prepare target dataframes (ID + time + label)
train_df, test_df = prepare_target_dataframes(train_data, test_data, metadata)

# 3) Parse metadata for DFS
key_mappings = {k: v for d in metadata["key_mappings"] for k, v in d.items()}
time_column = metadata["time_column"]
target_column = metadata["target_column"]

# 4) Generate features
train_features = generate_features(train_df, rdb, key_mappings, time_column)
test_features = generate_features(test_df, rdb, key_mappings, time_column)

# 5) Train and predict
engine = MultiTabFM()
engine.fit(train_features, label_column=target_column)
proba = engine.predict_proba(test_features)

# 6) Evaluate (optional if labels exist in test_features)
if target_column in test_features.columns:
    metrics = engine.evaluate(
        labels=test_features[target_column],
        proba=proba,
        metrics=["accuracy", "roc_auc", "logloss"],
    )
    print(metrics)
```

## Data layout and metadata

The step-by-step and one-call flows expect:
- `rdb_data_path/` readable by `fastdfs.load_rdb`
- `task_data_path/` containing:
  - `train.pqt` and `test.pqt` (parquet)
  - `metadata.yaml` with keys:

```yaml
dataset_name: rel-event
key_mappings:
  - user_id: users.user_id
  - item_id: items.item_id
time_column: interaction_time
target_column: label
```

## API reference

### Core class: MultiTabFM
- fit(train_features: pd.DataFrame, label_column: str, model_config: dict | None = None) -> None
- predict_proba(test_features: pd.DataFrame) -> np.ndarray
- evaluate(labels: pd.Series, proba: np.ndarray | pd.DataFrame, metrics: list[str] | None = None) -> dict
- train_and_predict(rdb_data_path: str, task_data_path: str, *, dfs_config: dict | None = None, model_config: dict | None = None, eval_metrics: list[str] | None = None) -> tuple[np.ndarray | pd.DataFrame, dict | None]

### Convenience API
- train_and_predict(...) — identical to `MultiTabFM.train_and_predict`, exposed at package top-level for one-call use.

### Utilities
- load_dataset(rdb_data_path: str, task_data_path: str) -> tuple[pd.DataFrame, pd.DataFrame, dict, Any]
- prepare_target_dataframes(train_data: pd.DataFrame, test_data: pd.DataFrame, metadata: dict) -> tuple[pd.DataFrame, pd.DataFrame]
- generate_features(target_df: pd.DataFrame, rdb: Any, key_mappings: dict, time_column: str, dfs_config: dict | None = None) -> pd.DataFrame
- get_default_configs() -> tuple[dict, dict]

### Model adapter
- AGAdapter — AutoGluon TabularPredictor wrapper used internally by `MultiTabFM`

Supported evaluation metrics: "accuracy", "roc_auc", "logloss".

## License

MIT

## Changelog

v0.1.0
- Initial release with DFS feature generation, AutoGluon integration, and basic metrics
